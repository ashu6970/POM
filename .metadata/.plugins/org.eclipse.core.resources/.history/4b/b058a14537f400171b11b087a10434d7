package com.main.product;

import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.util.Properties;
import java.util.concurrent.TimeUnit;
import org.openqa.selenium.JavascriptExecutor;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.chrome.ChromeDriver;

/**
 * 
 * @author Ashwani
 * @version 1.0
 */

public class Base_Test {

	public static WebDriver driver;
	public static Properties prop;
	public static File file;

	// Read the property file
	/**
	 * @param create the Common file to read the data 
	 * @exception if the path of the file does not find it's throws exception
	 */
	public static void readPropertyFile() {

		try {
			file = new File(System.getProperty("user.dir") + "/src/resource/java/config.prop");
			FileInputStream file_read = new FileInputStream(file);
			prop = new Properties();
			prop.load(file_read);

		} 
		catch (FileNotFoundException e) {
			e.printStackTrace();
		} catch (IOException e) {
			e.printStackTrace();
		}
	}
	/**
	 * @param It is intitialize the browser weather Mozilla or chrome.
	 * 
	 */

	public static void initializeBrowser() {
		// String browserName = prop.getProperty("browser");

		if (driver == null) {
			driver = new ChromeDriver();

			// if(browserName.equals("chrome")){
			// driver = new ChromeDriver();
		}
		/*
		 * else if(browserName.equals("FF")){ driver = new FirefoxDriver(); }
		 * else { System.out.println("Browser is not open"); }
		 */
		driver.get(prop.getProperty("url"));
		driver.manage().window().maximize();

	}

	public void waitForPageLoaded() {
		driver.manage().timeouts().implicitlyWait(20, TimeUnit.SECONDS);
	}

	public static void pageScrolldown() {
		JavascriptExecutor down = (JavascriptExecutor) driver;
		down.executeScript("window.scrollBy(0,500)", "");

	}

	public static void pageScrollUp() {
		JavascriptExecutor up = (JavascriptExecutor) driver;
		up.executeScript("scroll(0, -500);");
	}

	/**
	 * 
	 * @param element  it receive the xpath using javaScript method  
	 * @throws Exception if the element is not visible it throws no such element exception
	 */
	public static void javaScriptClick(WebElement element) throws Exception {
		try {
			if (element.isEnabled() && element.isDisplayed()) {

				((JavascriptExecutor) driver).executeScript("arguments[0].click();", element);
			} else {
				System.out.println("Unable to click on element");
			}
		} catch (Exception e) {
			System.out.println("Unable to click on element " + e.getStackTrace());
		}

	}

	public static void refresh() {
		driver.navigate().refresh();
	}

	
}
